# 3DMarker
このプログラムは、事前に用意された4点マーカーをステレオカメラにて検知して、測位を行いPC上に表示します。測位については、簡略的な実装なので、レンズのゆがみ等は考慮しておりませんので、画面中央付近ではないと動作が不安定になります。

## 動作環境
### プログラム言語  
Python  

### 必用なライブラリ
opencv-python  
opencv-contrib-python  
numpy  
matplotblib  

### 必用機材
WEBカメラ：２台  
今回は、簡易的な実装なので、ステレオカメラに使うカメラは同じ型式のカメラが望ましいです。

## 使用方法
### 手順１
"cameranumconfirm.py"にて、各カメラの画像に数字が加えられて描写されているので、これでどのカメラにどの番号が割り振られているのか確認を行う。特に、PC側にWEBカメラが内蔵されている機種は、カメラ番号に注意してください。

### 手順2
"markergenerator.py"にて、使用するマーカーを作成します。また、"ar_marker_0.png","ar_marker_1.png","ar_marker_2.png","ar_marker_3.png"の各マーカーや、"target.png"のようなマーカー4つを含む画像を用意していますので、こちらを使っても良いです。

### 手順3
"calibration.py"で、"ar_marker_0.png"を使って、キャリブレーションを行います。このキャリブレーションでは、レンズの歪等を考慮していませんので、対象はできるだけ画面中央に配置してください。なお、実測の必要がない場合は、この作業を飛ばしても構いません。

### 手順4
"markerdetection.py"で、検知したマーカーを基に、PC上に板として3D表示させます。3D表示については、matplotを応用したものなので、あまり描写にリアリティはありません。

## 問題点
・フレームレードが低い。これについては、マルチプロセスの実証を検証してみましたが、マルチスプロセスを施す上でのオーバーヘッドが速度向上を阻害したみたいです。また、Pythonのopencv処理はマルチスレッドで行われているようです。  
・測位精度が低い。これは、解像度が640*480としていることが原因と、ステレオカメラのキャリブレーションにおいて、外部、内部パラメータを取得し、反映できれば性能向上が可能であると考えられます。